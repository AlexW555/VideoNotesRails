<%= form_with model: note, url: notes_path, data: { turbo: true } do |f| %>
  <% if note.errors.any? %>
    <div class="mb-4 rounded-lg border border-red-200 bg-red-50 p-3 text-sm text-red-800">
      <p class="font-semibold"><%= pluralize(note.errors.count, "error") %> prevented saving:</p>
      <ul class="mt-2 list-disc pl-5">
        <% note.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%= f.hidden_field :timestamp_seconds,
        value: note.timestamp_seconds || 0,
        data: { "video-notes-target": "timestampInput" } %>

  <label class="block text-sm font-medium text-gray-700">Note</label>
  <%= f.text_area :body,
        rows: 4,
        placeholder: "What do you want to remember about this moment?",
        class: "mt-2 w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200" %>

  <div class="mt-4 flex items-center justify-between gap-3">
    <div class="flex items-center gap-2">
      <button
        type="button"
        data-action="click->video-notes#stampNow"
        class="rounded-lg bg-blue-600 px-3 py-2 text-sm font-semibold text-white hover:bg-blue-700">
        Stamp current time
      </button>

      <div class="rounded-lg bg-gray-100 px-3 py-2 text-sm text-gray-700">
        Time: <span class="font-semibold tabular-nums" data-video-notes-target="timestampDisplay"><%= note.timestamp_seconds || 0 %></span>s
      </div>
    </div>

    <%= f.submit "Save note",
      class: "rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white hover:bg-emerald-700" %>
  </div>
<% end %>
